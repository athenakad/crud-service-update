{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.219.0"},"children":{"ApiStack":{"id":"ApiStack","path":"ApiStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"InfluxDBVPC":{"id":"InfluxDBVPC","path":"ApiStack/InfluxDBVPC","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/InfluxDBVPC/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC"}]}}},"PublicSubnet1":{"id":"PublicSubnet1","path":"ApiStack/InfluxDBVPC/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.219.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"ApiStack/InfluxDBVPC/PublicSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.0.0/24","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"ApiStack/InfluxDBVPC/PublicSubnet1"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"Acl":{"id":"Acl","path":"ApiStack/InfluxDBVPC/PublicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ApiStack/InfluxDBVPC/PublicSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC/PublicSubnet1"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ApiStack/InfluxDBVPC/PublicSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"InfluxDBVPCPublicSubnet1RouteTableC6251C70"},"subnetId":{"Ref":"InfluxDBVPCPublicSubnet1SubnetFEF2D514"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ApiStack/InfluxDBVPC/PublicSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"InfluxDBVPCIGW129164ED"},"routeTableId":{"Ref":"InfluxDBVPCPublicSubnet1RouteTableC6251C70"}}}},"EIP":{"id":"EIP","path":"ApiStack/InfluxDBVPC/PublicSubnet1/EIP","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIP","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIP","aws:cdk:cloudformation:props":{"domain":"vpc","tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC/PublicSubnet1"}]}}},"NATGateway":{"id":"NATGateway","path":"ApiStack/InfluxDBVPC/PublicSubnet1/NATGateway","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnNatGateway","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::NatGateway","aws:cdk:cloudformation:props":{"allocationId":{"Fn::GetAtt":["InfluxDBVPCPublicSubnet1EIPAF56F07C","AllocationId"]},"subnetId":{"Ref":"InfluxDBVPCPublicSubnet1SubnetFEF2D514"},"tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC/PublicSubnet1"}]}}}}},"PublicSubnet2":{"id":"PublicSubnet2","path":"ApiStack/InfluxDBVPC/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.219.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"ApiStack/InfluxDBVPC/PublicSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[1,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.1.0/24","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"ApiStack/InfluxDBVPC/PublicSubnet2"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"Acl":{"id":"Acl","path":"ApiStack/InfluxDBVPC/PublicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ApiStack/InfluxDBVPC/PublicSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC/PublicSubnet2"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ApiStack/InfluxDBVPC/PublicSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"InfluxDBVPCPublicSubnet2RouteTable8678F493"},"subnetId":{"Ref":"InfluxDBVPCPublicSubnet2SubnetDBC0C445"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ApiStack/InfluxDBVPC/PublicSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"InfluxDBVPCIGW129164ED"},"routeTableId":{"Ref":"InfluxDBVPCPublicSubnet2RouteTable8678F493"}}}}}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"ApiStack/InfluxDBVPC/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.219.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"ApiStack/InfluxDBVPC/PrivateSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.2.0/24","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"ApiStack/InfluxDBVPC/PrivateSubnet1"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"Acl":{"id":"Acl","path":"ApiStack/InfluxDBVPC/PrivateSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ApiStack/InfluxDBVPC/PrivateSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC/PrivateSubnet1"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ApiStack/InfluxDBVPC/PrivateSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"InfluxDBVPCPrivateSubnet1RouteTable8B9C8854"},"subnetId":{"Ref":"InfluxDBVPCPrivateSubnet1Subnet0726A5B8"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ApiStack/InfluxDBVPC/PrivateSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"InfluxDBVPCPublicSubnet1NATGateway78E76536"},"routeTableId":{"Ref":"InfluxDBVPCPrivateSubnet1RouteTable8B9C8854"}}}}}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"ApiStack/InfluxDBVPC/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.219.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"ApiStack/InfluxDBVPC/PrivateSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[1,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.3.0/24","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"ApiStack/InfluxDBVPC/PrivateSubnet2"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"Acl":{"id":"Acl","path":"ApiStack/InfluxDBVPC/PrivateSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ApiStack/InfluxDBVPC/PrivateSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC/PrivateSubnet2"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ApiStack/InfluxDBVPC/PrivateSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"InfluxDBVPCPrivateSubnet2RouteTableF0A320B2"},"subnetId":{"Ref":"InfluxDBVPCPrivateSubnet2Subnet800242D0"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ApiStack/InfluxDBVPC/PrivateSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"InfluxDBVPCPublicSubnet1NATGateway78E76536"},"routeTableId":{"Ref":"InfluxDBVPCPrivateSubnet2RouteTableF0A320B2"}}}}}},"IGW":{"id":"IGW","path":"ApiStack/InfluxDBVPC/IGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ApiStack/InfluxDBVPC"}]}}},"VPCGW":{"id":"VPCGW","path":"ApiStack/InfluxDBVPC/VPCGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"InfluxDBVPCIGW129164ED"},"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}}}},"InfluxDBSG":{"id":"InfluxDBSG","path":"ApiStack/InfluxDBSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/InfluxDBSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for InfluxDB","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"from ApiStackAPISG6A845814:8086":{"id":"from ApiStackAPISG6A845814:8086","path":"ApiStack/InfluxDBSG/from ApiStackAPISG6A845814:8086","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow CRUD service to connect to InfluxDB","fromPort":8086,"groupId":{"Fn::GetAtt":["InfluxDBSG6B949B10","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["APISG13107CD2","GroupId"]},"toPort":8086}}}}},"APISG":{"id":"APISG","path":"ApiStack/APISG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/APISG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for CRUD API","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"from ApiStackCRUDServiceLBSecurityGroup470EDB36:8080":{"id":"from ApiStackCRUDServiceLBSecurityGroup470EDB36:8080","path":"ApiStack/APISG/from ApiStackCRUDServiceLBSecurityGroup470EDB36:8080","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Load balancer to target","fromPort":8080,"groupId":{"Fn::GetAtt":["APISG13107CD2","GroupId"]},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["CRUDServiceLBSecurityGroupBFDEBA95","GroupId"]},"toPort":8080}}}}},"InfluxDBInstance":{"id":"InfluxDBInstance","path":"ApiStack/InfluxDBInstance","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Instance","version":"2.219.0","metadata":[]},"children":{"InstanceRole":{"id":"InstanceRole","path":"ApiStack/InfluxDBInstance/InstanceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportInstanceRole":{"id":"ImportInstanceRole","path":"ApiStack/InfluxDBInstance/InstanceRole/ImportInstanceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ApiStack/InfluxDBInstance/InstanceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ec2.amazonaws.com"}}],"Version":"2012-10-17"},"tags":[{"key":"Name","value":"ApiStack/InfluxDBInstance"}]}}}}},"InstanceProfile":{"id":"InstanceProfile","path":"ApiStack/InfluxDBInstance/InstanceProfile","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnInstanceProfile","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::InstanceProfile","aws:cdk:cloudformation:props":{"roles":[{"Ref":"InfluxDBInstanceInstanceRole76DD5EB7"}]}}},"Resource":{"id":"Resource","path":"ApiStack/InfluxDBInstance/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInstance","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Instance","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"iamInstanceProfile":{"Ref":"InfluxDBInstanceInstanceProfile2E6707BD"},"imageId":{"Ref":"SsmParameterValueawsserviceamiamazonlinuxlatestamznamihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"},"instanceType":"t3.micro","securityGroupIds":[{"Fn::GetAtt":["InfluxDBSG6B949B10","GroupId"]}],"subnetId":{"Ref":"InfluxDBVPCPrivateSubnet1Subnet0726A5B8"},"tags":[{"key":"Name","value":"ApiStack/InfluxDBInstance"}],"userData":{"Fn::Base64":"#!/bin/bash\nsudo yum update -y\nsudo amazon-linux-extras install docker -y\nsudo service docker start\nsudo usermod -a -G docker ec2-user\ndocker run -d -p 8086:8086 --name influxdb influxdb:2.7"}}}}}},"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"ApiStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"ApiStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"CRUDCluster":{"id":"CRUDCluster","path":"ApiStack/CRUDCluster","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.Cluster","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDCluster/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnCluster","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Cluster","aws:cdk:cloudformation:props":{"clusterSettings":[{"name":"containerInsights","value":"enabled"}]}}}}},"TaskExecutionRole":{"id":"TaskExecutionRole","path":"ApiStack/TaskExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportTaskExecutionRole":{"id":"ImportTaskExecutionRole","path":"ApiStack/TaskExecutionRole/ImportTaskExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ApiStack/TaskExecutionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ApiStack/TaskExecutionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/TaskExecutionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ecr:BatchCheckLayerAvailability","ecr:GetDownloadUrlForLayer","ecr:BatchGetImage"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ecr:us-east-1:",{"Ref":"AWS::AccountId"},":repository/",{"Fn::Sub":"cdk-hnb659fds-container-assets-${AWS::AccountId}-us-east-1"}]]}},{"Action":"ecr:GetAuthorizationToken","Effect":"Allow","Resource":"*"},{"Action":["logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::GetAtt":["CRUDTaskDefinitionCRUDContainerLogGroupA3E9941E","Arn"]}}],"Version":"2012-10-17"},"policyName":"TaskExecutionRoleDefaultPolicyA84DD1B0","roles":[{"Ref":"TaskExecutionRole250D2532"}]}}}}}}},"TaskRole":{"id":"TaskRole","path":"ApiStack/TaskRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportTaskRole":{"id":"ImportTaskRole","path":"ApiStack/TaskRole/ImportTaskRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"ApiStack/TaskRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ApiStack/TaskRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/TaskRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"TaskRoleDefaultPolicy07FC53DE","roles":[{"Ref":"TaskRole30FC0FBB"}]}}}}}}},"CRUDTaskDefinition":{"id":"CRUDTaskDefinition","path":"ApiStack/CRUDTaskDefinition","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateTaskDefinition","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDTaskDefinition/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnTaskDefinition","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::TaskDefinition","aws:cdk:cloudformation:props":{"containerDefinitions":[{"essential":true,"image":{"Fn::Sub":"${AWS::AccountId}.dkr.ecr.us-east-1.${AWS::URLSuffix}/cdk-hnb659fds-container-assets-${AWS::AccountId}-us-east-1:adaeb0430f978935d3f0a3317f3a934b47875fd4b15a49a3956051ca40d5230a"},"name":"CRUDContainer","portMappings":[{"containerPort":8080,"protocol":"tcp"}],"logConfiguration":{"logDriver":"awslogs","options":{"awslogs-group":{"Ref":"CRUDTaskDefinitionCRUDContainerLogGroupA3E9941E"},"awslogs-stream-prefix":"crud-api","awslogs-region":"us-east-1"}},"environment":[{"name":"INFLUXDB_URL","value":"http://influxdb:8086"},{"name":"INFLUXDB_TOKEN","value":"zoDOvYbWDgPkPN5PEqsvIh4pC4wysm9aWHyCTIxzrw8qVRpyni79kvcYZ1HVIuOIsnHrq-V5-AY9qCkN_xdWrA=="},{"name":"INFLUXDB_ORG","value":"myorg"},{"name":"INFLUXDB_BUCKET","value":"mybucket"}]}],"cpu":"256","executionRoleArn":{"Fn::GetAtt":["TaskExecutionRole250D2532","Arn"]},"family":"ApiStackCRUDTaskDefinitionDEF7CE4B","memory":"512","networkMode":"awsvpc","requiresCompatibilities":["FARGATE"],"taskRoleArn":{"Fn::GetAtt":["TaskRole30FC0FBB","Arn"]}}}},"CRUDContainer":{"id":"CRUDContainer","path":"ApiStack/CRUDTaskDefinition/CRUDContainer","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.ContainerDefinition","version":"2.219.0"},"children":{"AssetImage":{"id":"AssetImage","path":"ApiStack/CRUDTaskDefinition/CRUDContainer/AssetImage","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr_assets.DockerImageAsset","version":"2.219.0"},"children":{"Staging":{"id":"Staging","path":"ApiStack/CRUDTaskDefinition/CRUDContainer/AssetImage/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.219.0"}},"Repository":{"id":"Repository","path":"ApiStack/CRUDTaskDefinition/CRUDContainer/AssetImage/Repository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.219.0","metadata":[]}}}},"LogGroup":{"id":"LogGroup","path":"ApiStack/CRUDTaskDefinition/CRUDContainer/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDTaskDefinition/CRUDContainer/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"retentionInDays":7}}}}}}}}},"CRUDService":{"id":"CRUDService","path":"ApiStack/CRUDService","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs_patterns.ApplicationLoadBalancedFargateService","version":"2.219.0"},"children":{"LB":{"id":"LB","path":"ApiStack/CRUDService/LB","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDService/LB/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnLoadBalancer","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::LoadBalancer","aws:cdk:cloudformation:props":{"loadBalancerAttributes":[{"key":"deletion_protection.enabled","value":"false"}],"scheme":"internet-facing","securityGroups":[{"Fn::GetAtt":["CRUDServiceLBSecurityGroupBFDEBA95","GroupId"]}],"subnets":[{"Ref":"InfluxDBVPCPublicSubnet1SubnetFEF2D514"},{"Ref":"InfluxDBVPCPublicSubnet2SubnetDBC0C445"}],"type":"application"}}},"SecurityGroup":{"id":"SecurityGroup","path":"ApiStack/CRUDService/LB/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDService/LB/SecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Automatically created Security Group for ELB ApiStackCRUDServiceLB121446FD","securityGroupIngress":[{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":80,"toPort":80,"description":"Allow from anyone on port 80"}],"vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}},"to ApiStackAPISG6A845814:8080":{"id":"to ApiStackAPISG6A845814:8080","path":"ApiStack/CRUDService/LB/SecurityGroup/to ApiStackAPISG6A845814:8080","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupEgress","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupEgress","aws:cdk:cloudformation:props":{"description":"Load balancer to target","destinationSecurityGroupId":{"Fn::GetAtt":["APISG13107CD2","GroupId"]},"fromPort":8080,"groupId":{"Fn::GetAtt":["CRUDServiceLBSecurityGroupBFDEBA95","GroupId"]},"ipProtocol":"tcp","toPort":8080}}}}},"PublicListener":{"id":"PublicListener","path":"ApiStack/CRUDService/LB/PublicListener","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDService/LB/PublicListener/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::Listener","aws:cdk:cloudformation:props":{"defaultActions":[{"type":"forward","targetGroupArn":{"Ref":"CRUDServiceLBPublicListenerECSGroupB7442B77"}}],"loadBalancerArn":{"Ref":"CRUDServiceLB150F554C"},"port":80,"protocol":"HTTP"}}},"ECSGroup":{"id":"ECSGroup","path":"ApiStack/CRUDService/LB/PublicListener/ECSGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationTargetGroup","version":"2.219.0"},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDService/LB/PublicListener/ECSGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnTargetGroup","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::TargetGroup","aws:cdk:cloudformation:props":{"port":80,"protocol":"HTTP","targetGroupAttributes":[{"key":"stickiness.enabled","value":"false"}],"targetType":"ip","vpcId":{"Ref":"InfluxDBVPC65DDE087"}}}}}}}}}},"LoadBalancerDNS":{"id":"LoadBalancerDNS","path":"ApiStack/CRUDService/LoadBalancerDNS","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"ServiceURL":{"id":"ServiceURL","path":"ApiStack/CRUDService/ServiceURL","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"Service":{"id":"Service","path":"ApiStack/CRUDService/Service","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateService","version":"2.219.0","metadata":[]},"children":{"Service":{"id":"Service","path":"ApiStack/CRUDService/Service/Service","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnService","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Service","aws:cdk:cloudformation:props":{"cluster":{"Ref":"CRUDClusterCCCB36A7"},"deploymentConfiguration":{"maximumPercent":200,"minimumHealthyPercent":50,"alarms":{"alarmNames":[],"enable":false,"rollback":false}},"desiredCount":2,"enableEcsManagedTags":false,"healthCheckGracePeriodSeconds":60,"launchType":"FARGATE","loadBalancers":[{"targetGroupArn":{"Ref":"CRUDServiceLBPublicListenerECSGroupB7442B77"},"containerName":"CRUDContainer","containerPort":8080}],"networkConfiguration":{"awsvpcConfiguration":{"assignPublicIp":"DISABLED","subnets":[{"Ref":"InfluxDBVPCPrivateSubnet1Subnet0726A5B8"},{"Ref":"InfluxDBVPCPrivateSubnet2Subnet800242D0"}],"securityGroups":[{"Fn::GetAtt":["APISG13107CD2","GroupId"]}]}},"taskDefinition":{"Ref":"CRUDTaskDefinition15F1BA04"}}}},"ScalingRole":{"id":"ScalingRole","path":"ApiStack/CRUDService/Service/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"TaskCount":{"id":"TaskCount","path":"ApiStack/CRUDService/Service/TaskCount","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.ScalableTaskCount","version":"2.219.0"},"children":{"Target":{"id":"Target","path":"ApiStack/CRUDService/Service/TaskCount/Target","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.ScalableTarget","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDService/Service/TaskCount/Target/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalableTarget","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalableTarget","aws:cdk:cloudformation:props":{"maxCapacity":10,"minCapacity":2,"resourceId":{"Fn::Join":["",["service/",{"Ref":"CRUDClusterCCCB36A7"},"/",{"Fn::GetAtt":["CRUDServiceA2E6DB4D","Name"]}]]},"roleArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::",{"Ref":"AWS::AccountId"},":role/aws-service-role/ecs.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_ECSService"]]},"scalableDimension":"ecs:service:DesiredCount","serviceNamespace":"ecs"}}},"CpuScaling":{"id":"CpuScaling","path":"ApiStack/CRUDService/Service/TaskCount/Target/CpuScaling","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.TargetTrackingScalingPolicy","version":"2.219.0"},"children":{"Resource":{"id":"Resource","path":"ApiStack/CRUDService/Service/TaskCount/Target/CpuScaling/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalingPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalingPolicy","aws:cdk:cloudformation:props":{"policyName":"ApiStackCRUDServiceTaskCountTargetCpuScalingCB17A650","policyType":"TargetTrackingScaling","scalingTargetId":{"Ref":"CRUDServiceTaskCountTarget5221E2AD"},"targetTrackingScalingPolicyConfiguration":{"predefinedMetricSpecification":{"predefinedMetricType":"ECSServiceAverageCPUUtilization"},"scaleInCooldown":60,"scaleOutCooldown":60,"targetValue":70}}}}}}}}}}}}}},"AlarmTopic":{"id":"AlarmTopic","path":"ApiStack/AlarmTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/AlarmTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"CRUD API Alarms"}}}}},"HighCPUAlarm":{"id":"HighCPUAlarm","path":"ApiStack/HighCPUAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/HighCPUAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlarmTopicD01E77F9"}],"comparisonOperator":"GreaterThanOrEqualToThreshold","datapointsToAlarm":2,"dimensions":[{"name":"ClusterName","value":{"Ref":"CRUDClusterCCCB36A7"}},{"name":"ServiceName","value":{"Fn::GetAtt":["CRUDServiceA2E6DB4D","Name"]}}],"evaluationPeriods":2,"metricName":"CPUUtilization","namespace":"AWS/ECS","period":300,"statistic":"Average","threshold":80,"treatMissingData":"notBreaching"}}}}},"HighMemoryAlarm":{"id":"HighMemoryAlarm","path":"ApiStack/HighMemoryAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ApiStack/HighMemoryAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlarmTopicD01E77F9"}],"comparisonOperator":"GreaterThanOrEqualToThreshold","datapointsToAlarm":2,"dimensions":[{"name":"ClusterName","value":{"Ref":"CRUDClusterCCCB36A7"}},{"name":"ServiceName","value":{"Fn::GetAtt":["CRUDServiceA2E6DB4D","Name"]}}],"evaluationPeriods":2,"metricName":"MemoryUtilization","namespace":"AWS/ECS","period":300,"statistic":"Average","threshold":80,"treatMissingData":"notBreaching"}}}}},"LoadBalancerDNS":{"id":"LoadBalancerDNS","path":"ApiStack/LoadBalancerDNS","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"ServiceURL":{"id":"ServiceURL","path":"ApiStack/ServiceURL","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"AlarmTopicArn":{"id":"AlarmTopicArn","path":"ApiStack/AlarmTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"InfluxDBPrivateIP":{"id":"InfluxDBPrivateIP","path":"ApiStack/InfluxDBPrivateIP","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ApiStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ApiStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ApiStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ApiStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}